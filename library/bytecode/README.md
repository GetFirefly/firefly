# Firefly Bytecode

This crate defines the instruction set for our bytecode emulator. It provides the following:

* A datastructure which is used to represent individual bytecode-compiled modules, as well as the
result of linking together several bytecode-compiled modules as a whole program, called `ByteCode`
* An instruction set optimized for the way our compiler generates code, of ~120 instructions (currently).
Many of these instructions are similar to those of a real ISA, but a number are fused instructions, performing
multiple operations at once, and a few are superinstructions which have quite complex implementations.
* A bytecode "builder" which can be used to iteratively construct a bytecode module without having to manage
any of the gritty details by hand.
* A textual format to allow for easy review of the generated bytecode in a form similar to our other IR formats
* A binary format to which bytecode-compiled programs are encoded/decoded when shipped as an executable
* Support for source-level debug info down to the instruction level

## Further Reading

You can find the compiler pass which generates this bytecode [here](`../compiler/driver/src/compiler/passes/bytecode/lower_ssa.rs`).

The current implementation of each opcode in our bytecode emulator can be found [here](`../runtimes/emulator/src/emulator/scheduler.rs`).

A detailed explanation of each instruction/opcode and its semantics can be found [here](src/ops.rs).
